plugins {
  id "com.github.jk1.dependency-license-report" version "1.6"
}
apply plugin: 'java-library'
apply plugin:'application'

repositories {
	//jcenter()
	//google()
	mavenCentral()
}
mainClassName = 'fb.InitWebsite'
sourceCompatibility = 1.11
targetCompatibility = 1.11

jar {
	from {
		(configurations.runtime).collect {
			it.isDirectory() ? it : zipTree(it)
		}
	}
	manifest {
		attributes("Main-Class": mainClassName )
	}
	exclude 'META-INF/*.RSA', 'META-INF/*.SF','META-INF/*.DSA' 
}
run {
	if (project.hasProperty('runArgs')) {
 		args findProperty('runArgs') 
 	}
 	standardInput = System.in
}
tasks.withType(JavaExec) {
    jvmArgs = ["-Xss16m", "-Xmx3072m"]
}

configurations {
	implementation {
		exclude group: 'javax.activation', module: 'activation'
		exclude group: 'javax.activation', module: 'javax.activation-api'
		exclude group: 'org.jvnet.staxex', module: 'stax-ex'
	}
	compile {
		exclude group: 'javax.activation', module: 'activation'
		exclude group: 'javax.activation', module: 'javax.activation-api'
		exclude group: 'org.jvnet.staxex', module: 'stax-ex'
	}
	runtime {
		exclude group: 'javax.activation', module: 'activation'
		exclude group: 'javax.activation', module: 'javax.activation-api'
		exclude group: 'org.jvnet.staxex', module: 'stax-ex'
	}
}

dependencies {
	
	compile group: 'jakarta.activation', name: 'jakarta.activation-api', version: '1.2.1'
	compile group: 'com.sun.activation', name: 'jakarta.activation', version: '1.2.1'
	
	compile group: 'org.slf4j', name: 'slf4j-simple', version: '1.7.26'
	
	// Stuff required for embedded jax-rs (jersey, grizzly)
	compile (group: 'org.glassfish.jersey.containers', name: 'jersey-container-grizzly2-http', version: '2.28') 
	compile (group: 'org.glassfish.jersey.inject', name: 'jersey-hk2', version: '2.28') 
	
	// Database access
	compile ('org.hibernate:hibernate-core:5.4.1.Final') 
	compile (group: 'org.hibernate', name: 'hibernate-c3p0', version: '5.4.1.Final') 
	compile (group: 'org.hibernate', name: 'hibernate-search-orm', version: '5.11.0.Final') 
	compile group: 'org.postgresql', name: 'postgresql', version: '42.2.5'
		
	// HTMLEscaper
	compile group: 'org.apache.commons', name: 'commons-text', version: '1.6'
	
	// Json
	compile group: 'com.google.code.gson', name: 'gson', version: '2.8.5'
	
	// Markdown
	/*compile group: 'com.vladsch.flexmark', name: 'flexmark', version: '0.40.12'
	compile group: 'com.vladsch.flexmark', name: 'flexmark-ext-gfm-strikethrough', version: '0.40.12'
	compile group: 'com.vladsch.flexmark', name: 'flexmark-ext-autolink', version: '0.40.12'
	compile group: 'com.vladsch.flexmark', name: 'flexmark-ext-tables', version: '0.40.12'
	compile group: 'com.vladsch.flexmark', name: 'flexmark-ext-superscript', version: '0.40.12'*/
	
	
	// Password hashing
	compile group: 'org.springframework.security', name: 'spring-security-crypto', version: '5.1.3.RELEASE'
	
	
	// Email address validation
	compile group: 'commons-validator', name: 'commons-validator', version: '1.6'
	
	// Sending email
	compile (group: 'com.sun.mail', name: 'javax.mail', version: '1.6.2') 
	
	// Generating RSS feeds
	compile group: 'com.rometools', name: 'rome', version: '1.12.0'
	
	compile group: 'com.github.wumpz', name: 'diffutils', version: '3.0'
	
	//compile group: 'com.squareup.okhttp3', name: 'okhttp', version: '4.0.1'
	compile group: 'net.gjerull.etherpad', name: 'etherpad_lite_client', version: '1.2.13'
	
}
